<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>K√ºtahya Ye≈üilay Futbol Okulu | Y√∂netim</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&family=Poppins:wght@400;700;900&display=swap" rel="stylesheet">
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sortablejs@1.15.0/Sortable.min.js"></script>
    <style>
        :root { --yesil: #006a33; --sari: #f1c40f; --koyu: #1a1a1b; --gri: #f4f7f6; --beyaz: #ffffff; }
        body, html { margin: 0; padding: 0; font-family: 'Inter', sans-serif; background: var(--gri); color: #333; }

        /* --- ANA Sƒ∞TE STƒ∞LLERƒ∞ --- */
        header { background: var(--yesil); color: white; padding: 20px 5%; display: flex; flex-direction: column; align-items: center; border-bottom: 5px solid var(--sari); }
        @media (min-width: 1024px) { header { flex-direction: row; justify-content: space-between; } }
        header h1 { font-family: 'Poppins'; font-weight: 900; font-size: 1.5rem; margin: 0; }
        nav { display: flex; gap: 15px; margin-top: 15px; }
        nav a { color: white; text-decoration: none; font-weight: 600; font-size: 0.9rem; cursor: pointer; text-transform: uppercase; }
        .admin-btn-top { background: var(--sari); color: var(--yesil); padding: 8px 15px; border-radius: 8px; border: none; font-weight: 800; cursor: pointer; }

        .main-content { padding: 30px 5%; }
        @media (min-width: 1024px) { .main-content { padding: 40px 10%; display: grid; grid-template-columns: 3fr 1fr; gap: 40px; } }
        
        .vitrin-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 15px; }
        .vitrin-item { width: 100%; height: 220px; border-radius: 15px; overflow: hidden; border: 4px solid white; box-shadow: 0 5px 15px rgba(0,0,0,0.1); cursor: pointer; }
        .vitrin-item img { width: 100%; height: 100%; transition: 0.3s; }

        .sidebar-ann { background: white; padding: 20px; border-radius: 20px; box-shadow: 0 5px 20px rgba(0,0,0,0.05); border-top: 5px solid var(--sari); }
        .ann-card { background: #f9f9f9; padding: 15px; border-radius: 12px; margin-bottom: 10px; border-left: 5px solid var(--yesil); }

        /* --- MODERN ADMƒ∞N PANEL --- */
        #admin-panel { display: none; position: fixed; inset: 0; background: var(--gri); z-index: 9999; flex-direction: column; }
        .admin-header { background: var(--koyu); color: white; padding: 15px 30px; display: flex; justify-content: space-between; align-items: center; }
        .admin-body { display: flex; flex: 1; overflow: hidden; }
        .admin-aside { width: 260px; background: #252526; display: flex; flex-direction: column; padding: 20px; gap: 10px; }
        .admin-menu-btn { padding: 12px 20px; color: #ccc; text-decoration: none; border-radius: 10px; font-weight: 600; cursor: pointer; transition: 0.2s; }
        .admin-menu-btn:hover, .admin-menu-btn.active { background: var(--yesil); color: white; }
        .admin-content { flex: 1; padding: 40px; overflow-y: auto; }
        
        .admin-card-ui { background: white; padding: 20px; border-radius: 15px; display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; box-shadow: 0 2px 10px rgba(0,0,0,0.02); }
        .action-btn { border: none; padding: 8px 14px; border-radius: 6px; cursor: pointer; font-weight: 600; font-size: 0.8rem; }
        
        /* MODALLAR */
        .modal { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.8); z-index: 10000; justify-content: center; align-items: center; padding: 20px; }
        .modal-box { background: white; padding: 30px; border-radius: 20px; width: 100%; max-width: 450px; position: relative; }
        .close-x { position: absolute; top: 15px; right: 20px; font-size: 25px; cursor: pointer; font-weight: 800; }

        /* Gƒ∞Rƒ∞≈û Sƒ∞STEMƒ∞ - Gƒ∞ZLƒ∞ */
        .login-input { width: 100%; padding: 12px; margin: 8px 0; border: 1px solid #ddd; border-radius: 10px; outline: none; }
        .login-btn { width: 100%; padding: 15px; background: var(--yesil); color: white; border: none; border-radius: 10px; font-weight: 800; cursor: pointer; margin-top: 10px; }

        /* FOTOƒûRAF AYAR √ñNƒ∞ZLEME */
        .pos-btn { padding: 5px 10px; margin: 2px; border: 1px solid #ddd; border-radius: 5px; cursor: pointer; font-size: 0.7rem; }
        .pos-btn.active { background: var(--yesil); color: white; }
    </style>
</head>
<body>

    <header>
        <h1>K√ºtahya Ye≈üilay Futbol Okulu</h1>
        <nav>
            <a onclick="location.reload()">ANASAYFA</a>
            <button class="admin-btn-top" onclick="openModal('login-modal')">Y√ñNETƒ∞M</button>
        </nav>
    </header>

    <div class="main-content" id="public-site">
        <div>
            <h2 style="font-family: 'Poppins'; font-weight: 900; color: var(--yesil);">ANTRENMAN KARELERƒ∞</h2>
            <div id="vitrin-area" class="vitrin-grid"></div>
        </div>
        <div class="sidebar-ann">
            <h3 style="margin-top:0;">üì¢ Duyurular</h3>
            <div id="ann-area"></div>
        </div>
    </div>

    <div id="admin-panel">
        <div class="admin-header">
            <b>YE≈ûƒ∞LAY OKULU Y√ñNETƒ∞M PANELƒ∞</b>
            <button onclick="location.reload()" style="background:none; color:white; border:1px solid white; padding:5px 15px; border-radius:5px; cursor:pointer;">PANELƒ∞ KAPAT</button>
        </div>
        <div class="admin-body">
            <div class="admin-aside">
                <div class="admin-menu-btn active" onclick="adminGo('vitrin', this)">üñºÔ∏è Antrenman Kareleri</div>
                <div class="admin-menu-btn" onclick="adminGo('anns', this)">üì¢ Duyurular</div>
                <div class="admin-menu-btn" onclick="adminGo('other', this)">‚öΩ Gruplar & Hocalar</div>
            </div>
            <div class="admin-content" id="admin-main-view"></div>
        </div>
    </div>

    <div id="login-modal" class="modal" onclick="closeModal('login-modal')">
        <div class="modal-box" onclick="event.stopPropagation()">
            <span class="close-x" onclick="closeModal('login-modal')">&times;</span>
            <h3 style="text-align: center;">Y√ñNETƒ∞Cƒ∞ Gƒ∞Rƒ∞≈ûƒ∞</h3>
            <input type="text" id="user" class="login-input" placeholder="Kullanƒ±cƒ± Adƒ±">
            <input type="password" id="pass" class="login-input" placeholder="≈ûifre">
            <button class="login-btn" onclick="checkLogin()">Sƒ∞STEME Gƒ∞R</button>
        </div>
    </div>

    <script>
        // --- FIREBASE VE VERƒ∞ ---
        const config = { databaseURL: "https://yesilay-futbol-okulu-default-rtdb.firebaseio.com/" };
        firebase.initializeApp(config);
        const dbRef = firebase.database().ref('/');
        let localData = { vitrin: [], duyurular: [], auth: { u: "ALƒ∞", p: "ALƒ∞43" } };

        dbRef.on('value', (snap) => {
            if(snap.val()) localData = snap.val();
            renderAll();
        });

        function save() { dbRef.set(localData); }

        function renderAll() {
            // Vitrin Render
            const v = document.getElementById('vitrin-area'); v.innerHTML = "";
            (localData.vitrin || []).forEach(img => {
                v.innerHTML += `<div class="vitrin-item"><img src="${img.src}" style="object-fit:cover; object-position:${img.pos || 'center'};"></div>`;
            });
            // Duyuru Render
            const a = document.getElementById('ann-area'); a.innerHTML = "";
            (localData.duyurular || []).forEach(item => {
                a.innerHTML += `<div class="ann-card"><b>${item.t}</b><p style="font-size:0.85rem; margin:5px 0 0 0;">${item.m}</p></div>`;
            });
        }

        function checkLogin() {
            const u = document.getElementById('user').value.trim().toUpperCase();
            const p = document.getElementById('pass').value.trim().toUpperCase();
            if(u === "ALƒ∞" && p === "ALƒ∞43") {
                closeModal('login-modal');
                document.getElementById('admin-panel').style.display = 'flex';
                adminGo('vitrin', document.querySelector('.admin-menu-btn.active'));
            } else { alert("Giri≈ü Ba≈üarƒ±sƒ±z!"); }
        }

        function adminGo(tab, btn) {
            document.querySelectorAll('.admin-menu-btn').forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
            const view = document.getElementById('admin-main-view');
            
            if(tab === 'vitrin') {
                view.innerHTML = `
                    <h2 style="margin-top:0;">Antrenman Karelerini Y√∂net</h2>
                    <div style="background:white; padding:20px; border-radius:15px; margin-bottom:20px;">
                        <label><b>Toplu Fotoƒüraf Y√ºkle:</b></label><br><br>
                        <input type="file" id="bulk-f" multiple accept="image/*" onchange="uploadBulk(event)">
                    </div>
                    <div id="sort-v" style="display:grid; grid-template-columns:repeat(auto-fill, minmax(150px, 1fr)); gap:15px;"></div>
                `;
                const sortArea = document.getElementById('sort-v');
                (localData.vitrin || []).forEach((img, i) => {
                    sortArea.innerHTML += `
                        <div data-id="${i}" style="background:white; padding:10px; border-radius:10px; position:relative; cursor:move;">
                            <img src="${img.src}" style="width:100%; height:100px; object-fit:cover; border-radius:5px; object-position:${img.pos || 'center'};">
                            <div style="margin-top:5px; text-align:center;">
                                <button class="pos-btn ${img.pos==='top'?'active':''}" onclick="setPos(${i}, 'top')">√úst</button>
                                <button class="pos-btn ${img.pos==='center'||!img.pos?'active':''}" onclick="setPos(${i}, 'center')">Orta</button>
                                <button class="pos-btn ${img.pos==='bottom'?'active':''}" onclick="setPos(${i}, 'bottom')">Alt</button>
                            </div>
                            <button onclick="delV(${i})" style="position:absolute; top:-5px; right:-5px; background:red; color:white; border:none; border-radius:50%; width:22px; height:22px; cursor:pointer;">&times;</button>
                        </div>
                    `;
                });
                new Sortable(sortArea, { animation: 150, onEnd: () => {
                    localData.vitrin = Array.from(sortArea.children).map(el => localData.vitrin[el.dataset.id]);
                    save(); adminGo('vitrin', btn);
                }});
            }
            if(tab === 'anns') {
                view.innerHTML = `
                    <h2 style="margin-top:0;">Duyurularƒ± Y√∂net</h2>
                    <button class="login-btn" style="width:auto; margin-bottom:20px;" onclick="addAnn()">+ Yeni Duyuru Ekle</button>
                    <div id="sort-a"></div>
                `;
                const sortA = document.getElementById('sort-a');
                (localData.duyurular || []).forEach((item, i) => {
                    sortA.innerHTML += `
                        <div data-id="${i}" class="admin-card-ui" style="cursor:move;">
                            <span><b>${item.t}</b></span>
                            <div>
                                <button class="action-btn" style="background:#e3f2fd;" onclick="editAnn(${i})">D√ºzenle</button>
                                <button class="action-btn" style="background:#ffebee; color:red;" onclick="delAnn(${i})">Sil</button>
                            </div>
                        </div>
                    `;
                });
                new Sortable(sortA, { animation: 150, onEnd: () => {
                    localData.duyurular = Array.from(sortA.children).map(el => localData.duyurular[el.dataset.id]);
                    save();
                }});
            }
        }

        // --- FONKSƒ∞YONLAR ---
        function uploadBulk(e) {
            const files = e.target.files;
            if(!localData.vitrin) localData.vitrin = [];
            Array.from(files).forEach(file => {
                const r = new FileReader();
                r.onload = (ev) => { localData.vitrin.unshift({ src: ev.target.result, pos: 'center' }); save(); };
                r.readAsDataURL(file);
            });
        }
        function setPos(i, p) { localData.vitrin[i].pos = p; save(); adminGo('vitrin', document.querySelector('.admin-menu-btn.active')); }
        function delV(i) { if(confirm("Silinsin mi?")) { localData.vitrin.splice(i, 1); save(); adminGo('vitrin', document.querySelector('.admin-menu-btn.active')); } }
        
        function addAnn() { const t=prompt("Ba≈ülƒ±k:"), m=prompt("Mesaj:"); if(t) { if(!localData.duyurular) localData.duyurular=[]; localData.duyurular.unshift({t, m}); save(); adminGo('anns', document.querySelector('.admin-menu-btn.active')); } }
        function editAnn(i) { const t=prompt("Yeni Ba≈ülƒ±k:", localData.duyurular[i].t), m=prompt("Yeni Mesaj:", localData.duyurular[i].m); if(t) { localData.duyurular[i] = {t, m}; save(); adminGo('anns', document.querySelector('.admin-menu-btn.active')); } }
        function delAnn(i) { if(confirm("Silinsin mi?")) { localData.duyurular.splice(i, 1); save(); adminGo('anns', document.querySelector('.admin-menu-btn.active')); } }

        function openModal(id) { document.getElementById(id).style.display = 'flex'; }
        function closeModal(id) { document.getElementById(id).style.display = 'none'; }
    </script>
</body>
</html>
